
# traffic-dl

国土交通省が公開している交通量データを取得する CLI ツール。

このツールの利用は自己責任。当方はこのツールにより生じた如何なる損害についても一切の責任を負わない。

> [!IMPORTANT]
> 日本道路交通情報センターが公開している API を使用するため、このツールを利用する前には[公式サイト](https://www.jartic-open-traffic.org/)で公開されている利用規約へ同意する必要がある。

## 利用方法

### 前提と実行

Rust のソースコードのみを公開しているため、ローカルマシンに Rust の実行環境が必要。[Rust 公式サイト](https://www.rust-lang.org/ja/tools/install)の記述に従い、インストールする必要がある。

### コマンドオプション

リポジトリからコードを `git clone` し、`cargo run -- <オプション>` で実行できる。

オプションの指定を行わない場合、例えば `cargo run -- 20250102` により実行した場合は、「当該日、1時間ごと、常設トラカンとCCTVトラカンの両方、高速自動車国道と一般国道の両方」を取得することになる。

#### 年月日・日時指定 【必須】

データの取得対象とする年月日・日時を指定する。

別オプションで指定可能な取得間隔（1時間 or 5分間）との組み合わせにより、実際に取得するデータの数が変わる。

##### 1時間交通量のとき

- `YYYYMMDD`: 1日分のデータを取得。最大24個。
- `YYYYMMDDHH`: 1時間分のデータを取得。最大1個。

##### 5分間交通量のとき

- `YYYYMMDD`: 1日分のデータを取得。最大288個。
- `YYYYMMDDHH`: 1時間分のデータを取得。最大12個。
- `YYYYMMDDHHMM`: 5分間分のデータを取得。最大1個。

#### 取得間隔 【省略可能】

データの取得間隔（= 交通量の観測時間）を指定する。

省略時は1時間ごとのデータのみを取得する。両方のデータを取得する場合は、両方のオプションを指定する必要がある。

- `--1h`: 1時間ごとのデータを取得 (デフォルト)
- `--5m`: 5分ごとのデータを取得

#### 観測機器 【省略可能】

常設トラカンとCCTVトラカンという2つの機器のうち、対象にする機器を指定する。観測機器ごとの取得するデータのフォーマットが異なるため、それぞれ別のファイルとして出力する。

省略時は両方の機器を対象とする。

- `--permanent`: 常設トラカンのみを取得対象とする
- `--cctv`: CCTVトラカンのみを取得対象とする

#### 道路種別 【省略可能】

高速自動車国道と一般国道のうち、対象にする道路を指定する。

省略時は両方の道路を対象とする。

- `--highway`: 高速自動車国道のみを取得対象とする
- `--normal`: 一般国道のみを取得対象とする

#### (テスト用) 先頭のデータのみを取得 【省略可能】

- `--one`: 先頭の1つのデータのみを取得・保存する

#### (テスト用) ドライラン 【省略可能】

- `--dry`: データの取得・保存を行わず、取得対象の URL 等の出力のみを行う


